"0","RK4SIR.Yang <- function(n, beta, gamma, S0, I0, R0 = 0, dt = 1) {"
"0","  N <<- S0 + I0 + R0  # fixed population"
"0","  "
"0","  S <- c(S0, rep(0, n))"
"0","  I <- c(I0, rep(0, n))"
"0","  R <- c(R0, rep(0, n))"
"0","  for (i in 1:n) {"
"0","    Si <- S[i]"
"0","    Ii <- I[i]"
"0","    S.k1 <- dSdt(i, Si, Ii)"
"0","    I.k1 <- dIdt(i, Si, Ii)"
"0","    "
"0","    Ts1 <- Si + dt / 2 * S.k1"
"0","    Ti1 <- Ii + dt / 2 * I.k1"
"0","    S.k2 <- dSdt(i + dt / 2, Ts1, Ti1)"
"0","    I.k2 <- dIdt(i + dt / 2, Ts1, Ti1)"
"0","    "
"0","    Ts2 <- Ts1 + dt / 2 * S.k2"
"0","    Ti2 <- Ti1 + dt / 2 * I.k2"
"0","    S.k3 <- dSdt(i + dt / 2, Ts2, Ti2)"
"0","    I.k3 <- dIdt(i + dt / 2, Ts2, Ti2)"
"0","    "
"0","    Ts3 <- Ts2 + dt * S.k3"
"0","    Ti3 <- Ti2 + dt * I.k3"
"0","    S.k4 <- dSdt(i + dt, Ts3, Ti3)"
"0","    I.k4 <- dIdt(i + dt, Ts3, Ti3)"
"0","    "
"0","    S[i + 1] <- Si + dt / 6 * (S.k1 + 2 * S.k2 + 2 * S.k3 + S.k4)"
"0","    I[i + 1] <- Ii + dt / 6 * (I.k1 + 2 * I.k2 + 2 * I.k3 + I.k4)"
"0","    R[i + 1] <- N - S[i + 1] - I[i + 1]"
"0","  }"
"0","  return(data.frame(n = 0:n, S = S, I = I, R = R))"
"0","}"
