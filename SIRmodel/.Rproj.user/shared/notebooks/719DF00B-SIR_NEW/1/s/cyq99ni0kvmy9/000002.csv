"0","RK4SIR <- function(n, beta, gamma, S0, I0, R0 = 0, dt = 1) {"
"0","  N <<- S0 + I0 + R0  # fixed population"
"0","  "
"0","  S <- c(S0, rep(0, n))"
"0","  I <- c(I0, rep(0, n))"
"0","  R <- c(R0, rep(0, n))"
"0","  for (i in 1:n) {"
"0","    Si <- S[i]"
"0","    Ii <- I[i]"
"0","#     Ri <- R[i]"
"0","    "
"0","    S.k1 <- dSdt(i, Si, Ii)"
"0","    I.k1 <- dIdt(i, Si, Ii)"
"0","#     R.k1 <- dRdt(i, Ii)"
"0","    "
"0","    S.k2 <- dSdt(i + dt / 2, Si + dt / 2 * S.k1, Ii + dt / 2 * I.k1)"
"0","    I.k2 <- dIdt(i + dt / 2, Si + dt / 2 * S.k1, Ii + dt / 2 * I.k1)"
"0","#     R.k2 <- dRdt(i + dt / 2, Ii + dt / 2 * I.k1)"
"0","    "
"0","    S.k3 <- dSdt(i + dt / 2, Si + dt / 2 * S.k2, Ii + dt / 2 * I.k2)"
"0","    I.k3 <- dIdt(i + dt / 2, Si + dt / 2 * S.k2, Ii + dt / 2 * I.k2)"
"0","#     R.k3 <- dRdt(i + dt / 2, Ii + dt / 2 * I.k2)"
"0","    "
"0","    S.k4 <- dSdt(i + dt, Si + dt * S.k3, Ii + dt * I.k3)"
"0","    I.k4 <- dIdt(i + dt, Si + dt * S.k3, Ii + dt * I.k3)"
"0","#     R.k4 <- dRdt(i + dt, Ii + dt * I.k3)"
"0","    "
"0","    S[i + 1] <- Si + dt / 6 * (S.k1 + 2 * S.k2 + 2 * S.k3 + S.k4)"
"0","    I[i + 1] <- Ii + dt / 6 * (I.k1 + 2 * I.k2 + 2 * I.k3 + I.k4)"
"0","#     R[i + 1] <- Ri + dt / 6 * (R.k1 + 2 * R.k2 + 2 * R.k3 + R.k4)"
"0","  }"
"0","  R <- N - S - I"
"0","  return(data.frame(n = 0:n, S = S, I = I, R = R))"
"0","}"
